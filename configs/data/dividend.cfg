INPUT stock
EXEC wrapped_stock=get_cninfo_mkt(stock)+stock
EXEC full_url='http://www.cninfo.com.cn/information/dividend/%s.html'%wrapped_stock
URL EXEC full_url
METHOD GET
STATUS 200
DECODE gbk
TO decoded_html

HEADER Accept:text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8
HEADER Accept-Encoding:gzip, deflate
HEADER Accept-Language:en-US,en;q=0.8,zh-CN;q=0.6
HEADER Cache-Control:no-cache
HEADER Host:www.cninfo.com.cn
HEADER Pragma:no-cache
HEADER Proxy-Connection:keep-alive
HEADER Referer:http://www.cninfo.com.cn/search/searchzx.jsp
HEADER Upgrade-Insecure-Requests:1
HEADER User-Agent:Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36

APPLY

EXEC soup=BeautifulSoup(decoded_html,'lxml')
EXEC table=soup.find("div", {"class": "clear"}).find('table')
EXEC converter_dict={'分红方案':converter_split_dividend,'红股上市日':converter_to_date,'股权登记日':converter_to_date,'除权基准日':converter_to_date}
EXEC fh_pd=pd.read_html(str(table),header=0,index_col=0,converters=converter_dict)[0]
EXEC fh_pd.to_csv('../stock_data/basic/split_dividend/%s.csv' % stock)
RETURN fh_pd










